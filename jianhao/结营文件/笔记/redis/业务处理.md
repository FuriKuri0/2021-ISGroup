## 读业务

1. ### 判断缓冲区中是否存在

   1. 存在，直接获取
   2. 不存在，从数据库中调出，再存入缓存，并设置超时时间



## 写业务

1. #### 先写入缓存再存入数据库

   1. 存在问题：两个线程并发运行，由于存入数据库时间相对于存入缓存的时间更长，线程1在完成存入缓存后，另一个线程2，要执行写命令，从而导致数据库中的数据与缓存中的数据不相同

      ![](https://raw.githubusercontent.com/JIaaoooo/ImageHostingService/main/img/%E5%86%99%E5%86%B2%E7%AA%81.png)

2. #### 先存入数据库再存入缓存

   1. 存在问题：

      - 条件一：此时缓存为空，

      - 条件二：线程1在执行存入缓存的1ms中，线程2执行完写操作(存数据库、存入缓存)

        - 满足则会出现缓存与数据库中的数据不相同

        ![](https://raw.githubusercontent.com/JIaaoooo/ImageHostingService/main/img/%E5%86%99%E5%86%B2%E7%AA%81(2).png)

### 由此看来，第二种写方式出现写冲突几率更小，故选择第二种方式